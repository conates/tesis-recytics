CREATE TABLE categoria (id BIGINT AUTO_INCREMENT, nombre_categoria VARCHAR(45) NOT NULL, descripcion VARCHAR(45) NOT NULL, tipo VARCHAR(45) NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE cliente (id BIGINT AUTO_INCREMENT, rut VARCHAR(10) NOT NULL, razon_social VARCHAR(45) NOT NULL, giro VARCHAR(45) NOT NULL, nombre_representante VARCHAR(45) NOT NULL, direccion VARCHAR(45), telefono_contacto BIGINT, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE container (id BIGINT AUTO_INCREMENT, capacidad BIGINT NOT NULL, tipo VARCHAR(45) NOT NULL, venta_chatarra_id BIGINT, INDEX venta_chatarra_id_idx (venta_chatarra_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE empleado (id BIGINT AUTO_INCREMENT, rut VARCHAR(10) NOT NULL, nombres VARCHAR(45) NOT NULL, apellidos VARCHAR(45) NOT NULL, email VARCHAR(45) NOT NULL UNIQUE, fecha_nac DATETIME, direccion VARCHAR(45), ciudad_residencia VARCHAR(45), telefono BIGINT NOT NULL, fecha_contrato DATETIME NOT NULL, fecha_fin_contrato DATETIME NOT NULL, sueldo BIGINT, user_id BIGINT UNIQUE, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE equipo (id BIGINT AUTO_INCREMENT, origen VARCHAR(45), marca VARCHAR(45) NOT NULL, peso BIGINT, estado TINYINT(1) NOT NULL, detalle VARCHAR(255), user_id BIGINT UNIQUE, categoria_id BIGINT, empleado_id BIGINT, venta_equipo_id BIGINT, INDEX venta_equipo_id_idx (venta_equipo_id), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE pieza (id BIGINT AUTO_INCREMENT, marca VARCHAR(45), estado TINYINT(1), detalle VARCHAR(45), user_id BIGINT UNIQUE, categoria_id BIGINT, empleado_id BIGINT, container_id BIGINT, venta_pieza_id BIGINT, INDEX venta_pieza_id_idx (venta_pieza_id), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE venta_chatarra (id BIGINT AUTO_INCREMENT, monto BIGINT NOT NULL, fecha DATETIME NOT NULL, detalle VARCHAR(255) NOT NULL, tipo VARCHAR(45) NOT NULL, cliente_id BIGINT, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE venta_equipo (id BIGINT AUTO_INCREMENT, fecha DATETIME NOT NULL, tipo VARCHAR(45) NOT NULL, monto BIGINT NOT NULL, detalle VARCHAR(255), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE venta_pieza (id BIGINT AUTO_INCREMENT, fecha DATETIME NOT NULL, tipo VARCHAR(45) NOT NULL, monto BIGINT NOT NULL, detalle VARCHAR(255), cliente VARCHAR(45) NOT NULL, gastos_envio BIGINT, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), email_address VARCHAR(255), username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128) NOT NULL, is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE container ADD CONSTRAINT container_venta_chatarra_id_venta_chatarra_id FOREIGN KEY (venta_chatarra_id) REFERENCES venta_chatarra(id);
ALTER TABLE empleado ADD CONSTRAINT empleado_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE equipo ADD CONSTRAINT equipo_venta_equipo_id_venta_equipo_id FOREIGN KEY (venta_equipo_id) REFERENCES venta_equipo(id);
ALTER TABLE equipo ADD CONSTRAINT equipo_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE pieza ADD CONSTRAINT pieza_venta_pieza_id_venta_pieza_id FOREIGN KEY (venta_pieza_id) REFERENCES venta_pieza(id) ON DELETE CASCADE;
ALTER TABLE pieza ADD CONSTRAINT pieza_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
